<!DOCTYPE html>
<html lang="es">
<head>  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EscÃ¡ner de Productos Lev 11</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
<main class="contenedor">
 <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
   <p id="contadorProductos" style="margin: 0;">mÃ¡s de 3,783,408 productos registrados de todo el mundo</p>
   <h1 style="margin: 0;">EscÃ¡ner de Productos Lev 11</h1>
</div>

  <div id="menuInicial">
    <button id="btnAbrirTahor">ğŸ§ª Verificador de productos Tahor</button>
    <button disabled>ğŸ Verificador de productos sin levadura (PrÃ³ximamente)</button>
  </div>

  <div id="bloqueTahor" style="display:none">
    <div id="tabs">
      <button id="tabBuscar" class="tab-activa">ğŸ” Buscar productos</button>
      <button id="tabRegistrar">ğŸ“ AyÃºdanos a registrar mÃ¡s productos</button>
      <button id="adminAccess" title="Administrador">ğŸ”</button>
    </div>

    <section id="buzonRevisiones" style="display:none">
      <h2>ğŸ“¬ BuzÃ³n de revisiones</h2>
      <div id="listaPendientes" class="grupo-formulario">
        <p>Cargando productos pendientes...</p>
      </div>
    </section>

    <section id="formBusquedaProducto" style="display:block;">
      <h2>Buscar Producto</h2>
      <div class="grupo-formulario">
        <label for="nombreEntrada">ğŸ” Nombre del producto *</label>
        <input type="text" id="nombreEntrada" placeholder="Ej: Cereal Natural...">

        <label for="marcaEntrada">Marca *</label>
        <input type="text" id="marcaEntrada" placeholder="Ej: Kellogg's">

        <label for="paisFiltro">PaÃ­s</label>
        <select id="paisFiltro">
          <option value="">-- Selecciona PaÃ­s (Opcional) --</option>
          <option value="MÃ©xico">MÃ©xico</option>
          <option value="USA">USA</option>
          <option value="EspaÃ±a">EspaÃ±a</option>
          <option value="Francia">Francia</option>
          <option value="Belice">Belice</option>
          <option value="Guatemala">Guatemala</option>
          <option value="Honduras">Honduras</option>
          <option value="El Salvador">El Salvador</option>
          <option value="Nicaragua">Nicaragua</option>
          <option value="Costa Rica">Costa Rica</option>
          <option value="PanamÃ¡">PanamÃ¡</option>
          <option value="Uruguay">Uruguay</option>
          <option value="Paraguay">Paraguay</option>
          <option value="Bolivia">Bolivia</option>
          <option value="Ecuador">Ecuador</option>
          <option value="RepÃºblica Dominicana">RepÃºblica Dominicana</option>
          <option value="Puerto Rico">Puerto Rico</option>
          <option value="Cuba">Cuba</option>
        </select>

        <button id="botonBusqueda">ğŸ” Buscar por nombre</button>
      </div>

      <div class="grupo-formulario" style="background:#f0f0f0">
        <label for="eanEntrada">ğŸ“· CÃ³digo de barras (EAN)</label>
        <input type="text" id="eanEntrada" placeholder="Ej: 750123456789">

        <label for="selectCamara">CÃ¡mara disponible:</label>
        <select id="selectCamara" class="dropdown-camara"></select>

        <div class="botones">
          <button id="escanearCodigo">ğŸ“· Escanear</button>
        </div>
      </div>
    </section>

    <section id="analisisResultado"></section>

    <section id="registroManual" style="display:none">
      <h2>Registrar Producto Manualmente</h2>
      <form id="formRegistroManual">
        <input type="text" id="marcaManual" placeholder="Marca del producto" required>
        <input type="text" id="nombreManual" placeholder="Nombre del producto" required>
        <input type="text" id="eanManual" placeholder="CÃ³digo de barras (opcional)">
        <input type="text" id="paisManual" placeholder="PaÃ­s o regiÃ³n" required>
        <textarea id="ingredientesManual" placeholder="Ingredientes separados por coma" required></textarea>

        <label><strong>Â¿Es Tahor o Tame?</strong></label>
        <div class="selector-tahor">
          <label id="labelTahor" for="tahor">
            <input type="radio" name="estadoTahor" id="tahor" value="true" required>
            âœ… Apto (Tahor)
          </label>
          <label id="labelTame" for="tame">
            <input type="radio" name="estadoTahor" id="tame" value="false" required>
            âŒ No Apto (Tame)
          </label>
        </div>

        <label for="imagenManual">ğŸ“· Subir imagen (opcional):</label>
        <input type="url" id="imagenManual" placeholder="URL de la imagen del producto">

        <button type="submit">Enviar a RevisiÃ³n</button>
      </form>

      <p id="mensajeUsuario"></p>
    </section>

    <section id="adminPanel" style="display:none; margin-top:2rem">
      <h2>Modo Administrador</h2>
    </section>
  </div>
</main>

<footer id="menuInferior">
  <button onclick="document.getElementById('tabBuscar').click()">ğŸ” Buscar</button>
  <button onclick="document.getElementById('tabRegistrar').click()">ğŸ“ Registrar</button>
  <button onclick="document.getElementById('adminAccess').click()">ğŸ” Admin</button>
</footer>

<button id="btnArriba" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">â¬†ï¸</button>

<!-- Scripts -->
<script src="tahor-checker.js"></script>
<script src="https://unpkg.com/@zxing/library@0.18.6/umd/index.min.js"></script>
<script src="main.js"></script>
<script src="lectorBase.js"></script>
<script src="cargandogithub.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@octokit/rest@19.0.7/dist/octokit.umd.js" onload="loadAdmin()"></script>
<script>
  function loadAdmin() {
    const script = document.createElement("script");
    script.src = "admin.js";
    document.body.appendChild(script);
  }
</script>
<script>
  let adminAutenticado = false;

  function activarTab(idActiva) {
    document.querySelectorAll('#tabs button').forEach(btn => btn.classList.remove('tab-activa'));
    document.getElementById(idActiva).classList.add('tab-activa');
  }

  document.getElementById('tabBuscar').addEventListener('click', () => {
    document.getElementById('formBusquedaProducto').style.display = 'block';
    document.getElementById('analisisResultado').style.display = 'block';
    document.getElementById('registroManual').style.display = 'none';
    document.getElementById('buzonRevisiones').style.display = 'none';
    activarTab('tabBuscar');
  });

  document.getElementById('tabRegistrar').addEventListener('click', () => {
    document.getElementById('formBusquedaProducto').style.display = 'none';
    document.getElementById('analisisResultado').style.display = 'none';
    document.getElementById('registroManual').style.display = 'block';
    document.getElementById('buzonRevisiones').style.display = 'none';
    activarTab('tabRegistrar');
  });

  document.getElementById('adminAccess').addEventListener('click', () => {
    if (adminAutenticado) {
      mostrarBuzonAdmin();
      return;
    }
    const pass = prompt("ğŸ”‘ Ingresa la contraseÃ±a de administrador:");
    if (pass === "levitico11") {
      adminAutenticado = true;
      document.getElementById('adminPanel').style.display = 'block';
      mostrarBuzonAdmin();
      alert("âœ… Acceso concedido al modo administrador.");
    } else {
      alert("âŒ ContraseÃ±a incorrecta.");
    }
  });

  function mostrarBuzonAdmin() {
    document.getElementById('buzonRevisiones').style.display = 'block';
    document.getElementById('formBusquedaProducto').style.display = 'none';
    document.getElementById('registroManual').style.display = 'none';
    activarTab('adminAccess');
  }

  document.addEventListener("DOMContentLoaded", () => {
    activarTab('tabBuscar');
    document.getElementById('formBusquedaProducto').style.display = 'block';
    document.getElementById('analisisResultado').style.display = 'block';
  });

  // Cerrar teclado al hacer clic fuera de inputs
  document.addEventListener('click', function (e) {
    if (!e.target.closest('input, textarea, select')) {
      document.activeElement.blur();
    }
  });

  // BotÃ³n para volver arriba visible solo al hacer scroll
  window.addEventListener("scroll", () => {
    document.getElementById("btnArriba").style.display =
      window.scrollY > 300 ? "block" : "none";
  });
</script>
</body>
</html>
